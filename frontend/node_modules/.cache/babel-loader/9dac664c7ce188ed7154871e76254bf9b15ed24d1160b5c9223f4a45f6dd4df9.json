{"ast":null,"code":"import React,{useState,useEffect}from'react';import{UserAuth}from'../context/AuthContext';import ReactSearchBox from\"react-search-box\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const PromoteAdmin=()=>{const[guestdata,setGuestData]=useState([]);const[guestselect,setGuestSelect]=useState();const[guestbutton,setGuestButton]=useState(false);const fetchGuestEmails=async()=>{try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/fetchrole?roleName=Guest');const[guestRole]=await response.json();if(guestRole){let guestEmails=[];guestRole.Roles.forEach(member=>{for(let i=0;i<member.Emails.length;i++){const email=member.Emails[i];const userid=member.Userid[i];guestEmails.push({key:userid,value:email});}});setGuestData(guestEmails);}}catch(error){console.error('Failed to fetch guest list',error);}};const handleGuestUser=async()=>{if(!guestselect)return;const userId=guestselect.item.key;const userEmail=guestselect.item.value;try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/promoteuser',{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,userEmail})});const data=await response.json();console.log(data.message);}catch(error){console.error('Failed to promote user',error);}setGuestButton(false);};const handleSelect=record=>{setGuestSelect(record);setGuestButton(true);};useEffect(()=>{fetchGuestEmails();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"Guest Users\"}),/*#__PURE__*/_jsx(ReactSearchBox,{placeholder:\"Promote User\",value:\"Doe\",data:guestdata,onSelect:handleSelect}),guestselect&&guestbutton&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Guest to Admin\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGuestUser,children:\"Promote User\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setGuestButton(false),children:\"No\"})]})})]});};export default PromoteAdmin;","map":{"version":3,"names":["React","useState","useEffect","UserAuth","ReactSearchBox","jsx","_jsx","jsxs","_jsxs","PromoteAdmin","guestdata","setGuestData","guestselect","setGuestSelect","guestbutton","setGuestButton","fetchGuestEmails","response","fetch","guestRole","json","guestEmails","Roles","forEach","member","i","Emails","length","email","userid","Userid","push","key","value","error","console","handleGuestUser","userId","item","userEmail","method","headers","body","JSON","stringify","data","log","message","handleSelect","record","children","placeholder","onSelect","onClick"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/frontend/src/components/promoteadmin.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {UserAuth} from '../context/AuthContext'\nimport ReactSearchBox from \"react-search-box\";\n\nconst PromoteAdmin = () => {\n    const [guestdata, setGuestData] = useState([]);\n    const [guestselect, setGuestSelect] = useState();\n    const [guestbutton, setGuestButton] = useState(false);\n\n\n    const fetchGuestEmails = async () => {\n        try {\n            const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/fetchrole?roleName=Guest');\n            const [guestRole] = await response.json();\n\n            if(guestRole)\n            {\n                let guestEmails =[];\n                guestRole.Roles.forEach(member => {\n                    for(let i = 0; i< member.Emails.length; i++) {\n                        const email = member.Emails[i];\n                        const userid = member.Userid[i]; \n                        guestEmails.push ({\n                            key: userid,\n                            value: email,\n                        });\n                    }\n                });\n                    \n                setGuestData(guestEmails);\n            }\n        } catch (error) {\n            console.error('Failed to fetch guest list', error);\n        }\n    }\n\n    const handleGuestUser = async () => {\n        if(!guestselect)\n            return;\n        const userId = guestselect.item.key;\n        const userEmail = guestselect.item.value;\n\n        try {\n            const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/promoteuser', {\n                method: 'PATCH',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ userId, userEmail }),\n            });\n\n            const data = await response.json();\n            console.log(data.message);\n\n        } catch (error) {\n            console.error('Failed to promote user', error);\n        }\n\n        setGuestButton(false);\n    }\n\n    const handleSelect = (record) => {\n        setGuestSelect(record);\n        setGuestButton(true);\n    }\n\n    useEffect(()=> {\n        fetchGuestEmails();\n    }, [])\n    return (\n        <div>\n            <br />\n            <p>Guest Users</p>\n            <ReactSearchBox\n                placeholder='Promote User'\n                value = \"Doe\"\n                data = {guestdata}\n                onSelect ={handleSelect}\n            />\n             {guestselect && guestbutton && (\n                <div>\n                <div>\n                    <p>Guest to Admin</p>\n                    <button onClick={handleGuestUser}>Promote User</button>\n                    <button onClick={()=>setGuestButton(false)}>No</button>\n                </div>   \n\n             </div>\n            )}\n        </div>\n    )\n}\n\nexport default PromoteAdmin;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Navigate}from'react-router-dom';import{UserAuth}from'../context/AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const AdminProtected=_ref=>{let{children}=_ref;const{user}=UserAuth();const current_user=user.email;const[shouldRedirect,setShouldRedirect]=useState(false);const checkMembersInRole=(role,userEmail)=>{return fetch(\"https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=\".concat(encodeURIComponent(role),\"&current_user=\").concat(encodeURIComponent(userEmail))).then(response=>response.json()).then(data=>{console.log(data.message);return data.message.includes(\"Member exists in role\");}).catch(error=>{console.error('Error',error);return false;});};const fetchUpperRoles=async()=>{try{const isGuest=await checkMembersInRole('Guest',current_user);if(isGuest){console.log(\"The user is a guest\",current_user);setShouldRedirect(true);}else{console.log(\"The user is upper role\");}}catch(error){console.error(\"Error Fetching DA Role\",error);}};useEffect(()=>{fetchUpperRoles();},[current_user]);if(shouldRedirect){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}return children;};export default AdminProtected;","map":{"version":3,"names":["React","useState","useEffect","Navigate","UserAuth","jsx","_jsx","AdminProtected","_ref","children","user","current_user","email","shouldRedirect","setShouldRedirect","checkMembersInRole","role","userEmail","fetch","concat","encodeURIComponent","then","response","json","data","console","log","message","includes","catch","error","fetchUpperRoles","isGuest","to"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/frontend/src/components/adminprotected.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {Navigate} from 'react-router-dom'\nimport {UserAuth} from '../context/AuthContext'\n\nconst AdminProtected = ({children}) => {\n    const {user} = UserAuth();\n    const current_user = user.email;\n    const [shouldRedirect, setShouldRedirect] = useState(false);\n\n    const checkMembersInRole = (role, userEmail)  => {\n        return fetch(`https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=${encodeURIComponent(role)}&current_user=${encodeURIComponent(userEmail)}`)\n             .then(response => response.json())\n             .then(data=> {\n                 console.log(data.message);\n                 return data.message.includes(\"Member exists in role\");\n             })\n             .catch(error => {\n                 console.error('Error', error);\n                 return false;\n             });\n     }\n\n     const fetchUpperRoles = async () => { \n        try {\n            const isGuest = await checkMembersInRole('Guest', current_user);\n            if(isGuest) {\n                console.log(\"The user is a guest\", current_user)\n                setShouldRedirect(true);\n            }\n            else {\n                console.log(\"The user is upper role\")\n            }\n        } catch (error) {\n            console.error(\"Error Fetching DA Role\", error);\n        }\n    }\n    useEffect(() => {\n        fetchUpperRoles();\n    }, [current_user])\n\n    if(shouldRedirect) {\n        return <Navigate to='/' />;\n    }\n    return children\n};\n\nexport default AdminProtected;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAGC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CAChD,OAAQC,QAAQ,KAAO,kBAAkB,CACzC,OAAQC,QAAQ,KAAO,wBAAwB,QAAAC,GAAA,IAAAC,IAAA,yBAE/C,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAgB,IAAf,CAACC,QAAQ,CAAC,CAAAD,IAAA,CAC9B,KAAM,CAACE,IAAI,CAAC,CAAGN,QAAQ,CAAC,CAAC,CACzB,KAAM,CAAAO,YAAY,CAAGD,IAAI,CAACE,KAAK,CAC/B,KAAM,CAACC,cAAc,CAAEC,iBAAiB,CAAC,CAAGb,QAAQ,CAAC,KAAK,CAAC,CAE3D,KAAM,CAAAc,kBAAkB,CAAGA,CAACC,IAAI,CAAEC,SAAS,GAAM,CAC7C,MAAO,CAAAC,KAAK,gEAAAC,MAAA,CAAgEC,kBAAkB,CAACJ,IAAI,CAAC,mBAAAG,MAAA,CAAiBC,kBAAkB,CAACH,SAAS,CAAC,CAAE,CAAC,CAC/II,IAAI,CAACC,QAAQ,EAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAG,CACTC,OAAO,CAACC,GAAG,CAACF,IAAI,CAACG,OAAO,CAAC,CACzB,MAAO,CAAAH,IAAI,CAACG,OAAO,CAACC,QAAQ,CAAC,uBAAuB,CAAC,CACzD,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,EAAI,CACZL,OAAO,CAACK,KAAK,CAAC,OAAO,CAAEA,KAAK,CAAC,CAC7B,MAAO,MAAK,CAChB,CAAC,CAAC,CACV,CAAC,CAED,KAAM,CAAAC,eAAe,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACA,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAAjB,kBAAkB,CAAC,OAAO,CAAEJ,YAAY,CAAC,CAC/D,GAAGqB,OAAO,CAAE,CACRP,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAEf,YAAY,CAAC,CAChDG,iBAAiB,CAAC,IAAI,CAAC,CAC3B,CAAC,IACI,CACDW,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC,CACzC,CACJ,CAAE,MAAOI,KAAK,CAAE,CACZL,OAAO,CAACK,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAClD,CACJ,CAAC,CACD5B,SAAS,CAAC,IAAM,CACZ6B,eAAe,CAAC,CAAC,CACrB,CAAC,CAAE,CAACpB,YAAY,CAAC,CAAC,CAElB,GAAGE,cAAc,CAAE,CACf,mBAAOP,IAAA,CAACH,QAAQ,EAAC8B,EAAE,CAAC,GAAG,CAAE,CAAC,CAC9B,CACA,MAAO,CAAAxB,QAAQ,CACnB,CAAC,CAED,cAAe,CAAAF,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
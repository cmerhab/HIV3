{"ast":null,"code":"import React,{useState,useEffect}from'react';import ReactSearchBox from\"react-search-box\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const DemoteAdmin=()=>{const[admindata,setAdminData]=useState([]);const[adminbutton,setAdminButton]=useState(false);const[adminselect,setAdminSelect]=useState();const fetchAdminEmails=async()=>{try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/fetchrole?roleName=Admin');const[adminRole]=await response.json();if(adminRole){let adminEmails=[];adminRole.Roles.forEach(member=>{for(let i=0;i<member.Emails.length;i++){const email=member.Emails[i];const userid=member.Userid[i];adminEmails.push({key:userid,value:email});}});setAdminData(adminEmails);}}catch(error){console.error('Failed to fetch admin list',error);}};const handleSelect=record=>{setAdminSelect(record);setAdminButton(true);};const handleAdminUser=async flag=>{if(!adminselect)return;const userId=adminselect.item.key;const userEmail=adminselect.item.value;if(flag===1){try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/banadmin',{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,userEmail})});const data=await response.json();console.log(data.message);}catch(error){console.error('Failed to ban admin',error);}}else if(flag===0){try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/demoteadmin',{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,userEmail})});const data=await response.json();console.log(data.message);}catch(error){console.error('Failed to demote admin',error);}}setAdminButton(false);};useEffect(()=>{fetchAdminEmails();});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"Admin Users\"}),/*#__PURE__*/_jsx(ReactSearchBox,{placeholder:\"Demote User\",value:\"Doe\",data:admindata,onSelect:handleSelect}),adminselect&&adminbutton&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Admin to Guest\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAdminUser(0),children:\"Demote User\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAdminButton(false),children:\"No\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Admin to Banned\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAdminUser(1),children:\"Ban User\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAdminButton(false),children:\"No\"})]})]})]});};export default DemoteAdmin;","map":{"version":3,"names":["React","useState","useEffect","ReactSearchBox","jsx","_jsx","jsxs","_jsxs","DemoteAdmin","admindata","setAdminData","adminbutton","setAdminButton","adminselect","setAdminSelect","fetchAdminEmails","response","fetch","adminRole","json","adminEmails","Roles","forEach","member","i","Emails","length","email","userid","Userid","push","key","value","error","console","handleSelect","record","handleAdminUser","flag","userId","item","userEmail","method","headers","body","JSON","stringify","data","log","message","children","placeholder","onSelect","onClick"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/frontend/src/components/demoteadmin.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\nimport ReactSearchBox from \"react-search-box\";\nconst DemoteAdmin = () => {\n    const [admindata, setAdminData] = useState([]);\n    const [adminbutton, setAdminButton] = useState(false);\n    const [adminselect, setAdminSelect] = useState();\n\n    const fetchAdminEmails = async () => {\n        try {\n            const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/fetchrole?roleName=Admin');\n            const [adminRole] = await response.json();\n\n            if(adminRole)\n            {\n                let adminEmails =[];\n                adminRole.Roles.forEach(member => {\n                    for(let i = 0; i< member.Emails.length; i++) {\n                        const email = member.Emails[i];\n                        const userid = member.Userid[i]; \n                        adminEmails.push ({\n                            key: userid,\n                            value: email,\n                        });\n                    }\n                });\n                setAdminData(adminEmails);\n            }\n        } catch (error) {\n            console.error('Failed to fetch admin list', error);\n        }\n    };\n\n    const handleSelect = (record) => {\n        setAdminSelect(record);\n        setAdminButton(true);\n    }\n\n    const handleAdminUser = async (flag) => {\n        if(!adminselect)\n            return;\n        const userId = adminselect.item.key;\n        const userEmail = adminselect.item.value;\n            if(flag===1)\n            {\n                try {\n                    const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/banadmin', {\n                        method: 'PATCH',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({ userId, userEmail }),\n                    });\n        \n                    const data = await response.json();\n                    console.log(data.message);\n        \n                } catch (error) {\n                    console.error('Failed to ban admin', error);\n                }\n            }\n            else if(flag === 0 )\n            {\n                try {\n                    const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/demoteadmin', {\n                        method: 'PATCH',\n                        headers: {\n                            'Content-Type': 'application/json',\n                        },\n                        body: JSON.stringify({ userId, userEmail }),\n                    });\n        \n                    const data = await response.json();\n                    console.log(data.message);\n        \n                } catch (error) {\n                    console.error('Failed to demote admin', error);\n                }\n            }\n           \n        setAdminButton(false);\n    }\n\n    useEffect(() => {\n        fetchAdminEmails();\n    })\n    return (\n        <div>\n            <br />\n            <p>Admin Users</p>\n            <ReactSearchBox\n                placeholder='Demote User'\n                value = \"Doe\"\n                data = {admindata}\n                onSelect = {handleSelect}\n\n            />\n             {adminselect && adminbutton && (\n                <div>\n                    <div>\n                        <p>Admin to Guest</p>\n                        <button onClick={()=>handleAdminUser(0)}>Demote User</button>\n                        <button onClick={()=>setAdminButton(false)}>No</button>\n                    </div>\n                    <div>\n                        <p>Admin to Banned</p>\n                        <button onClick={()=>handleAdminUser(1)}>Ban User</button>\n                        <button onClick={()=>setAdminButton(false)}>No</button>\n                    </div>\n\n                 </div>\n             )}\n        </div>\n    )\n};\nexport default DemoteAdmin;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
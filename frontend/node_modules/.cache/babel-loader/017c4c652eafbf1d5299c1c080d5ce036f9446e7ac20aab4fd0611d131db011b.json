{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\".././styles/Home.css\";import Topbar from\"../components/topbar.js\";import Clocktime from\"../components/clock.js\";import Livefeed from\"../components/livefeed.js\";import Pastdata from\"../components/pastdata.js\";import CurrentCount from\"../components/currentcount.js\";import{Link}from\"react-router-dom\";import{UserAuth}from'../context/AuthContext';import{Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const{user,logOut}=UserAuth();const current_user=user.email;const current_user_id=user.uid;const[temperature,SetTemp]=useState(0.0);const[humidity,SetHumidity]=useState(0.0);const[windspeed,SetWindSpeed]=useState(0.0);/*Finding if user has a role*/ /*End Of Finding if user has a role*/const checkMembersInRole=(role,userEmail)=>{//console.log(role);\n//console.log(userEmail);\nreturn fetch(\"https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=\".concat(encodeURIComponent(role),\"&current_user=\").concat(encodeURIComponent(userEmail))).then(response=>response.json()).then(data=>{console.log(data.message);return data.message.includes(\"Member exists in role\");}).catch(error=>{console.error('Error',error);return false;});};const fetchOwnerRole=async()=>{try{const isOwner=await checkMembersInRole('Owner',current_user);const isAdmin=await checkMembersInRole('Admin',current_user);const isGuest=await checkMembersInRole('Guest',current_user);const isBanned=await checkMembersInRole('Banned',current_user);if(isOwner){console.log(\"The user is a member of owner\");}else if(isAdmin){console.log(\"The user is a member of admin\");}else if(isGuest){console.log(\"The user is a member of guest\");}else if(isBanned){//Will need to rethink this, banned user can escape by clicking other link fast\nreturn[/*#__PURE__*/_jsx(Navigate,{to:\"/signin\"}),logOut()];}else{console.log(\"The user is not any role yet\");assignUser();}}catch(error){console.error(\"Error Fetching DA Role\",error);}};const Weather=async()=>{let url='https://api.openweathermap.org/data/2.5/weather?zip=95014,us&appid=733cc9a44ea1fb2deea063b934b579fd&units=imperial';const response=await fetch(url);const weather=await response.json();console.log(weather);SetTemp(weather.main.temp);SetWindSpeed(weather.wind.speed);SetHumidity(weather.main.humidity);};const assignUser=async()=>{console.log(\"Unassigned User Detected.. Launching Function\");const roleId=\"e024\";//RoleId = guest\nconst memberData={aemail:current_user,userid:current_user_id,roleId:roleId};try{const response=await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/members',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(memberData)});const responseBody=await response.text();console.log('Raw Response',responseBody);if(!response.ok){throw new Error('failed to add guest');}const data=JSON.parse(responseBody);console.log('Member Added successfully',data);}catch(error){console.error('Error adding member:',error);}};useEffect(()=>{if(current_user){fetchOwnerRole();}Weather();});return/*#__PURE__*/_jsxs(\"div\",{class:\"homepage\",children:[/*#__PURE__*/_jsx(Topbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"firstCol\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"camera-info\",children:[/*#__PURE__*/_jsx(\"p1\",{children:\"Camera Name: \"}),/*#__PURE__*/_jsx(Clocktime,{}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"Temperature: \",temperature,\"\\xB0F\",/*#__PURE__*/_jsx(\"br\",{}),\" \"]}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"Humidity: \",humidity,\" % \",/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"p1\",{children:[\"Wind Speed: \",windspeed,\" mph\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Manage_Camera\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/ManageCamera\",className:\"titles\",children:\"Manage Camera\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"Live_View\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/LiveView\",className:\"titles\",children:\"LiveView\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"View_Data\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/ViewData\",className:\"titles\",children:\"View Data\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"secondCol\",children:[/*#__PURE__*/_jsx(Livefeed,{}),/*#__PURE__*/_jsx(CurrentCount,{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"thirdCol\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fourthCol\",children:/*#__PURE__*/_jsx(Pastdata,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"fifthCol\"})]})]});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","Topbar","Clocktime","Livefeed","Pastdata","CurrentCount","Link","UserAuth","Navigate","jsx","_jsx","jsxs","_jsxs","Home","user","logOut","current_user","email","current_user_id","uid","temperature","SetTemp","humidity","SetHumidity","windspeed","SetWindSpeed","checkMembersInRole","role","userEmail","fetch","concat","encodeURIComponent","then","response","json","data","console","log","message","includes","catch","error","fetchOwnerRole","isOwner","isAdmin","isGuest","isBanned","to","assignUser","Weather","url","weather","main","temp","wind","speed","roleId","memberData","aemail","userid","method","headers","body","JSON","stringify","responseBody","text","ok","Error","parse","class","children","className"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/frontend/src/pages/Home.js"],"sourcesContent":["import React, {useEffect,useState} from \"react\"; \nimport \".././styles/Home.css\";\nimport Topbar from \"../components/topbar.js\"\nimport Clocktime from \"../components/clock.js\"\nimport Livefeed from \"../components/livefeed.js\"\nimport Pastdata from \"../components/pastdata.js\"\nimport CurrentCount from \"../components/currentcount.js\"\nimport { Link } from \"react-router-dom\";\nimport {UserAuth} from '../context/AuthContext'\nimport {Navigate} from 'react-router-dom'\n\n\n\nconst Home = () => {\n    const {user, logOut} = UserAuth();\n    const current_user = user.email;\n    const current_user_id = user.uid;\n    const [temperature,SetTemp] = useState(0.0);\n    const [humidity,SetHumidity] = useState(0.0);\n    const [windspeed,SetWindSpeed] = useState(0.0);\n\n    /*Finding if user has a role*/\n    /*End Of Finding if user has a role*/\n    const checkMembersInRole = (role, userEmail)  => {\n        //console.log(role);\n        //console.log(userEmail);\n       return fetch(`https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=${encodeURIComponent(role)}&current_user=${encodeURIComponent(userEmail)}`)\n            .then(response => response.json())\n            .then(data=> {\n                console.log(data.message);\n                return data.message.includes(\"Member exists in role\");\n            })\n            .catch(error => {\n                console.error('Error', error);\n                return false;\n            });\n    }\n\n\n\n    const fetchOwnerRole = async () => {\n        \n        try {\n            const isOwner = await checkMembersInRole('Owner', current_user);\n            const isAdmin = await checkMembersInRole('Admin', current_user);\n            const isGuest = await checkMembersInRole('Guest', current_user);\n            const isBanned = await checkMembersInRole('Banned', current_user);\n            if(isOwner) {\n                console.log(\"The user is a member of owner\")\n            }\n            else if(isAdmin){\n                console.log(\"The user is a member of admin\")\n            }\n            else if(isGuest) {\n                console.log(\"The user is a member of guest\")\n            }\n            else if(isBanned) { //Will need to rethink this, banned user can escape by clicking other link fast\n                return [ \n                <Navigate to='/signin' />,\n                logOut()\n                ];\n            }\n             else {\n                console.log(\"The user is not any role yet\")\n                assignUser();\n            }\n        } catch (error) {\n            console.error(\"Error Fetching DA Role\", error);\n        }\n    }\n    const Weather= async () => {\n        let url='https://api.openweathermap.org/data/2.5/weather?zip=95014,us&appid=733cc9a44ea1fb2deea063b934b579fd&units=imperial';\n        const response = await fetch(url);\n        const weather = await response.json();\n        console.log(weather);\n        SetTemp(weather.main.temp);\n        SetWindSpeed(weather.wind.speed);\n        SetHumidity(weather.main.humidity);\n        \n    };\n\n    const assignUser = async () =>{\n       console.log(\"Unassigned User Detected.. Launching Function\");\n        const roleId = \"e024\"; //RoleId = guest\n       const memberData = { aemail: current_user, userid: current_user_id, roleId: roleId};\n\n       try {\n            const response = await fetch('https://hiv3-app-1abe045e0a88.herokuapp.com/members', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(memberData)\n            });\n            const responseBody = await response.text();\n            console.log('Raw Response', responseBody);\n\n            if(!response.ok) {\n                throw new Error('failed to add guest');\n            }\n\n            const data = JSON.parse(responseBody);\n            console.log('Member Added successfully', data);\n       } catch (error) {\n        console.error('Error adding member:', error)\n       }\n    }\n\n    useEffect(() => {\n        if(current_user) {\n            fetchOwnerRole();\n    }\n\n        Weather();\n\n});\n\n    return (\n        <div class=\"homepage\">\n            <Topbar />\n            <div className=\"container\">\n            <div className=\"firstCol\">\n                <div className=\"camera-info\">\n                    <p1>Camera Name: </p1> \n                     <Clocktime />\n                     <p1>Temperature: {temperature}°F<br/> </p1>\n                     <p1>Humidity: {humidity} % <br/></p1>\n                     <p1>Wind Speed: {windspeed} mph</p1>\n                </div>\n                <div className =\"Manage_Camera\">\n                    <button className =\"Sidebar_Button\">\n                    <Link to='/ManageCamera' className=\"titles\">Manage Camera</Link>\n                    </button>\n                </div>\n                <div className =\"Live_View\">\n                    <button className=\"Sidebar_Button\">\n                        <Link to='/LiveView' className=\"titles\">LiveView</Link>\n                    </button>\n                </div>\n                <div className =\"View_Data\">\n                    <button className=\"Sidebar_Button\">\n                    <Link to='/ViewData' className=\"titles\">View Data</Link>\n                    </button>\n                </div>\n    \n            </div>\n            <div className=\"secondCol\">\n                <Livefeed/>\n                <CurrentCount/>\n            </div>\n            <div className=\"thirdCol\">\n            </div>\n            <div className=\"fourthCol\">\n            <Pastdata />\n            </div>\n            <div className=\"fifthCol\">\n            </div>\n        </div>\n\n        </div>\n\n\n    );\n\n};\nexport default Home;\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{UserAuth}from'../context/AuthContext';import\".././styles/Account.css\";import Topbar from\"../components/topbar.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Account=_ref=>{let{setAdminPopup}=_ref;const{user,logOut}=UserAuth();const[userisadmin,setUserIsAdmin]=useState(false);const[userisowner,setUserIsOwner]=useState(false);const current_user=user.email;const checkMembersInRole=(role,userEmail)=>{return fetch(\"https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=\".concat(encodeURIComponent(role),\"&current_user=\").concat(encodeURIComponent(userEmail))).then(response=>response.json()).then(data=>{console.log(data.message);return data.message.includes(\"Member exists in role\");}).catch(error=>{console.error('Error',error);return false;});};const fetchUpperRoles=async()=>{try{const isOwner=await checkMembersInRole('Owner',current_user);const isAdmin=await checkMembersInRole('Admin',current_user);if(isOwner){setUserIsOwner(true);}else if(isAdmin){setUserIsAdmin(true);}else{console.log(\"The user is not upper role\");}}catch(error){console.error(\"Error Fetching DA Role\",error);}};const handleSignOut=async()=>{try{await logOut();}catch(error){console.log(error);}};useEffect(()=>{fetchUpperRoles();});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Topbar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"PositionBox\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"OrangeBox\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"Profile\",children:\"Profile Details\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"img\",{src:user===null||user===void 0?void 0:user.photoURL,className:\"UserPhoto\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"UserDetails\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Welcome, \",user===null||user===void 0?void 0:user.displayName]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",user===null||user===void 0?void 0:user.email]})]}),(userisadmin||userisowner)&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAdminPopup(true),children:\"Admin Config\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSignOut,className:\"SignOutButton\",children:\"Logout\"})]})})]});};export default Account;/*\n  {user?.displayName ? (  //Currently viewing account, you should only be logged in but this is a test before we add in protected pages\n                <button onClick={handleSignOut}>Logout</button>\n            ) : ( \n                <Link to='/signin'>Sign In</Link>\n            )}\n*/","map":{"version":3,"names":["React","useState","useEffect","UserAuth","Topbar","jsx","_jsx","jsxs","_jsxs","Account","_ref","setAdminPopup","user","logOut","userisadmin","setUserIsAdmin","userisowner","setUserIsOwner","current_user","email","checkMembersInRole","role","userEmail","fetch","concat","encodeURIComponent","then","response","json","data","console","log","message","includes","catch","error","fetchUpperRoles","isOwner","isAdmin","handleSignOut","children","className","src","photoURL","displayName","onClick"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/frontend/src/components/account.js"],"sourcesContent":["import React, {useState, useEffect} from \"react\"; \nimport { UserAuth } from '../context/AuthContext';\nimport \".././styles/Account.css\"\nimport Topbar from \"../components/topbar.js\"\n\nconst Account = ({setAdminPopup}) => {\n\n    const {user, logOut } = UserAuth();\n    const [userisadmin, setUserIsAdmin] = useState(false);\n    const [userisowner, setUserIsOwner] = useState(false);\n    const current_user = user.email;\n\n    const checkMembersInRole = (role, userEmail)  => {\n        return fetch(`https://hiv3-app-1abe045e0a88.herokuapp.com/findmember?role=${encodeURIComponent(role)}&current_user=${encodeURIComponent(userEmail)}`)\n             .then(response => response.json())\n             .then(data=> {\n                 console.log(data.message);\n                 return data.message.includes(\"Member exists in role\");\n             })\n             .catch(error => {\n                 console.error('Error', error);\n                 return false;\n             });\n     }\n     const fetchUpperRoles = async () => { \n        try {\n            const isOwner = await checkMembersInRole('Owner', current_user);\n            const isAdmin = await checkMembersInRole('Admin', current_user);\n            if(isOwner) {\n                setUserIsOwner(true);\n            } else if(isAdmin) {\n                setUserIsAdmin(true);\n            }\n            else {\n                console.log(\"The user is not upper role\")\n            }\n        } catch (error) {\n            console.error(\"Error Fetching DA Role\", error);\n        }\n    }\n\n    const handleSignOut = async () => {\n        try {\n            await logOut();\n        } catch(error) {\n            console.log(error)\n        }\n    }\n    useEffect(() => {\n        fetchUpperRoles();\n    })\n\n    return (\n   \n        <div>\n            <Topbar />\n            <div className='PositionBox'>\n                <div className='OrangeBox'>\n                    <h1 className='Profile'>Profile Details</h1>\n                    <br />\n                    <br />\n                    <img src={user?.photoURL} className=\"UserPhoto\" />\n                    <br />\n                    <br /> \n                    <div className='UserDetails'>\n                        <p>Welcome, {user?.displayName}</p> \n                        <p>Email: {user?.email}</p>\n                    </div>\n                    {(userisadmin || userisowner) && <button onClick={()=>setAdminPopup(true)}>Admin Config</button>} \n                    <button onClick={handleSignOut} className=\"SignOutButton\">Logout</button>\n                </div>\n            </div>\n        </div>\n    )\n}\nexport default Account;\n\n\n/*\n  {user?.displayName ? (  //Currently viewing account, you should only be logged in but this is a test before we add in protected pages\n                <button onClick={handleSignOut}>Logout</button>\n            ) : ( \n                <Link to='/signin'>Sign In</Link>\n            )}\n*/"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
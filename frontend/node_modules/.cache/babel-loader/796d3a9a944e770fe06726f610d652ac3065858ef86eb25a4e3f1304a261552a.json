{"ast":null,"code":"import React,{useEffect}from\"react\";import\".././styles/Home.css\";import Topbar from\"../components/topbar.js\";import Clocktime from\"../components/clock.js\";import Livefeed from\"../components/livefeed.js\";import Pastdata from\"../components/pastdata.js\";import CurrentCount from\"../components/currentcount.js\";import{Link}from\"react-router-dom\";import{UserAuth}from'../context/AuthContext';import{Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const{user,logOut}=UserAuth();const current_user=user.email;const current_user_id=user.uid;/*Finding if user has a role*/ /*End Of Finding if user has a role*/const checkMembersInRole=(role,userEmail)=>{//console.log(role);\n//console.log(userEmail);\nreturn fetch(\"http://localhost:4000/findmember?role=\".concat(encodeURIComponent(role),\"&current_user=\").concat(encodeURIComponent(userEmail))).then(response=>response.json()).then(data=>{console.log(data.message);return data.message.includes(\"Member exists in role\");}).catch(error=>{console.error('Error',error);return false;});};const fetchOwnerRole=async()=>{try{const isOwner=await checkMembersInRole('Owner',current_user);const isAdmin=await checkMembersInRole('Admin',current_user);const isGuest=await checkMembersInRole('Guest',current_user);const isBanned=await checkMembersInRole('Banned',current_user);if(isOwner){console.log(\"The user is a member of owner\");}else if(isAdmin){console.log(\"The user is a member of admin\");}else if(isGuest){console.log(\"The user is a member of guest\");}else if(isBanned){//Will need to rethink this, banned user can escape by clicking other link fast\nreturn[/*#__PURE__*/_jsx(Navigate,{to:\"/signin\"}),logOut()];}else{console.log(\"The user is not any role yet\");assignUser();}}catch(error){console.error(\"Error Fetching DA Role\",error);}};const assignUser=async()=>{console.log(\"Unassigned User Detected.. Launching Function\");const roleId=\"e024\";//RoleId = guest\nconst memberData={aemail:current_user,userid:current_user_id,roleId:roleId};try{const response=await fetch('http://localhost:4000/members',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(memberData)});const responseBody=await response.text();console.log('Raw Response',responseBody);if(!response.ok){throw new Error('failed to add guest');}const data=JSON.parse(responseBody);console.log('Member Added successfully',data);}catch(error){console.error('Error adding member:',error);}};useEffect(()=>{if(current_user){fetchOwnerRole();}});return/*#__PURE__*/_jsxs(\"div\",{class:\"homepage\",children:[/*#__PURE__*/_jsx(Topbar,{}),/*#__PURE__*/_jsx(Livefeed,{}),/*#__PURE__*/_jsx(CurrentCount,{}),/*#__PURE__*/_jsx(Pastdata,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"left-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"camera-info\",children:[/*#__PURE__*/_jsx(\"p1\",{children:\"Camera Name: \"}),/*#__PURE__*/_jsx(Clocktime,{}),/*#__PURE__*/_jsx(\"p1\",{children:\"Local Temperature: \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"Manage_Camera\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/ManageCamera\",className:\"titles\",children:\"Manage Camera\"})})}),/*#__PURE__*/_jsx(\"div\",{class:\"Modify_Perms\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/ModifyPerms\",className:\"titles\",children:\"Modify Permissions\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"Live_View\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/LiveView\",className:\"titles\",children:\"LiveView\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"View_Data\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Sidebar_Button\",children:/*#__PURE__*/_jsx(Link,{to:\"/ViewData\",className:\"titles\",children:\"View Data\"})})})]})]});};export default Home;","map":{"version":3,"names":["React","useEffect","Topbar","Clocktime","Livefeed","Pastdata","CurrentCount","Link","UserAuth","Navigate","jsx","_jsx","jsxs","_jsxs","Home","user","logOut","current_user","email","current_user_id","uid","checkMembersInRole","role","userEmail","fetch","concat","encodeURIComponent","then","response","json","data","console","log","message","includes","catch","error","fetchOwnerRole","isOwner","isAdmin","isGuest","isBanned","to","assignUser","roleId","memberData","aemail","userid","method","headers","body","JSON","stringify","responseBody","text","ok","Error","parse","class","children","className"],"sources":["/Users/cmerhab/Desktop/React/Hiv3/src/pages/Home.js"],"sourcesContent":["import React, {useEffect} from \"react\"; \nimport \".././styles/Home.css\";\nimport Topbar from \"../components/topbar.js\"\nimport Clocktime from \"../components/clock.js\"\nimport Livefeed from \"../components/livefeed.js\"\nimport Pastdata from \"../components/pastdata.js\"\nimport CurrentCount from \"../components/currentcount.js\"\nimport { Link } from \"react-router-dom\";\nimport {UserAuth} from '../context/AuthContext'\nimport {Navigate} from 'react-router-dom'\n\n\n\nconst Home = () => {\n    const {user, logOut} = UserAuth();\n    const current_user = user.email;\n    const current_user_id = user.uid;\n    /*Finding if user has a role*/\n    /*End Of Finding if user has a role*/\n    const checkMembersInRole = (role, userEmail)  => {\n        //console.log(role);\n        //console.log(userEmail);\n       return fetch(`http://localhost:4000/findmember?role=${encodeURIComponent(role)}&current_user=${encodeURIComponent(userEmail)}`)\n            .then(response => response.json())\n            .then(data=> {\n                console.log(data.message);\n                return data.message.includes(\"Member exists in role\");\n            })\n            .catch(error => {\n                console.error('Error', error);\n                return false;\n            });\n    }\n\n\n\n    const fetchOwnerRole = async () => {\n        \n        try {\n            const isOwner = await checkMembersInRole('Owner', current_user);\n            const isAdmin = await checkMembersInRole('Admin', current_user);\n            const isGuest = await checkMembersInRole('Guest', current_user);\n            const isBanned = await checkMembersInRole('Banned', current_user);\n            if(isOwner) {\n                console.log(\"The user is a member of owner\")\n            }\n            else if(isAdmin){\n                console.log(\"The user is a member of admin\")\n            }\n            else if(isGuest) {\n                console.log(\"The user is a member of guest\")\n            }\n            else if(isBanned) { //Will need to rethink this, banned user can escape by clicking other link fast\n                return [ \n                <Navigate to='/signin' />,\n                logOut()\n                ];\n            }\n             else {\n                console.log(\"The user is not any role yet\")\n                assignUser();\n            }\n        } catch (error) {\n            console.error(\"Error Fetching DA Role\", error);\n        }\n    }\n\n    const assignUser = async () =>{\n       console.log(\"Unassigned User Detected.. Launching Function\");\n        const roleId = \"e024\"; //RoleId = guest\n       const memberData = { aemail: current_user, userid: current_user_id, roleId: roleId};\n\n       try {\n            const response = await fetch('http://localhost:4000/members', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(memberData)\n            });\n            const responseBody = await response.text();\n            console.log('Raw Response', responseBody);\n\n            if(!response.ok) {\n                throw new Error('failed to add guest');\n            }\n\n            const data = JSON.parse(responseBody);\n            console.log('Member Added successfully', data);\n       } catch (error) {\n        console.error('Error adding member:', error)\n       }\n    }\n\n    useEffect(() => {\n        if(current_user) {\n            fetchOwnerRole();\n    }\n\n});\n\n\n    return (\n        <div class=\"homepage\">\n            <Topbar />\n            <Livefeed/>\n            <CurrentCount />\n            <Pastdata />\n            <div className=\"left-box\">\n                <div className=\"camera-info\">\n                    <p1>Camera Name: </p1> \n                     <Clocktime />\n                    <p1>Local Temperature: </p1>\n                </div>\n                <div className =\"Manage_Camera\">\n                    <button className =\"Sidebar_Button\">\n                    <Link to='/ManageCamera' className=\"titles\">Manage Camera</Link>\n                    </button>\n                </div>\n                <div class =\"Modify_Perms\">\n                    <button className=\"Sidebar_Button\">\n                    <Link to='/ModifyPerms' className=\"titles\">Modify Permissions</Link>\n                    </button>\n                </div>\n                <div className =\"Live_View\">\n                    <button className=\"Sidebar_Button\">\n                        <Link to='/LiveView' className=\"titles\">LiveView</Link>\n                    </button>\n                </div>\n                <div className =\"View_Data\">\n                    <button className=\"Sidebar_Button\">\n                    <Link to='/ViewData' className=\"titles\">View Data</Link>\n                    </button>\n                </div>\n    \n            </div>\n   \n\n        </div>\n\n\n    );\n\n};\nexport default Home;\n\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAGC,SAAS,KAAO,OAAO,CACtC,MAAO,sBAAsB,CAC7B,MAAO,CAAAC,MAAM,KAAM,yBAAyB,CAC5C,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAC9C,MAAO,CAAAC,QAAQ,KAAM,2BAA2B,CAChD,MAAO,CAAAC,QAAQ,KAAM,2BAA2B,CAChD,MAAO,CAAAC,YAAY,KAAM,+BAA+B,CACxD,OAASC,IAAI,KAAQ,kBAAkB,CACvC,OAAQC,QAAQ,KAAO,wBAAwB,CAC/C,OAAQC,QAAQ,KAAO,kBAAkB,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAIzC,KAAM,CAAAC,IAAI,CAAGA,CAAA,GAAM,CACf,KAAM,CAACC,IAAI,CAAEC,MAAM,CAAC,CAAGR,QAAQ,CAAC,CAAC,CACjC,KAAM,CAAAS,YAAY,CAAGF,IAAI,CAACG,KAAK,CAC/B,KAAM,CAAAC,eAAe,CAAGJ,IAAI,CAACK,GAAG,CAChC,+BACA,qCACA,KAAM,CAAAC,kBAAkB,CAAGA,CAACC,IAAI,CAAEC,SAAS,GAAM,CAC7C;AACA;AACD,MAAO,CAAAC,KAAK,0CAAAC,MAAA,CAA0CC,kBAAkB,CAACJ,IAAI,CAAC,mBAAAG,MAAA,CAAiBC,kBAAkB,CAACH,SAAS,CAAC,CAAE,CAAC,CACzHI,IAAI,CAACC,QAAQ,EAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAG,CACTC,OAAO,CAACC,GAAG,CAACF,IAAI,CAACG,OAAO,CAAC,CACzB,MAAO,CAAAH,IAAI,CAACG,OAAO,CAACC,QAAQ,CAAC,uBAAuB,CAAC,CACzD,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,EAAI,CACZL,OAAO,CAACK,KAAK,CAAC,OAAO,CAAEA,KAAK,CAAC,CAC7B,MAAO,MAAK,CAChB,CAAC,CAAC,CACV,CAAC,CAID,KAAM,CAAAC,cAAc,CAAG,KAAAA,CAAA,GAAY,CAE/B,GAAI,CACA,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAAjB,kBAAkB,CAAC,OAAO,CAAEJ,YAAY,CAAC,CAC/D,KAAM,CAAAsB,OAAO,CAAG,KAAM,CAAAlB,kBAAkB,CAAC,OAAO,CAAEJ,YAAY,CAAC,CAC/D,KAAM,CAAAuB,OAAO,CAAG,KAAM,CAAAnB,kBAAkB,CAAC,OAAO,CAAEJ,YAAY,CAAC,CAC/D,KAAM,CAAAwB,QAAQ,CAAG,KAAM,CAAApB,kBAAkB,CAAC,QAAQ,CAAEJ,YAAY,CAAC,CACjE,GAAGqB,OAAO,CAAE,CACRP,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAChD,CAAC,IACI,IAAGO,OAAO,CAAC,CACZR,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAChD,CAAC,IACI,IAAGQ,OAAO,CAAE,CACbT,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAChD,CAAC,IACI,IAAGS,QAAQ,CAAE,CAAE;AAChB,MAAO,cACP9B,IAAA,CAACF,QAAQ,EAACiC,EAAE,CAAC,SAAS,CAAE,CAAC,CACzB1B,MAAM,CAAC,CAAC,CACP,CACL,CAAC,IACK,CACFe,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAC3CW,UAAU,CAAC,CAAC,CAChB,CACJ,CAAE,MAAOP,KAAK,CAAE,CACZL,OAAO,CAACK,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAClD,CACJ,CAAC,CAED,KAAM,CAAAO,UAAU,CAAG,KAAAA,CAAA,GAAW,CAC3BZ,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC,CAC3D,KAAM,CAAAY,MAAM,CAAG,MAAM,CAAE;AACxB,KAAM,CAAAC,UAAU,CAAG,CAAEC,MAAM,CAAE7B,YAAY,CAAE8B,MAAM,CAAE5B,eAAe,CAAEyB,MAAM,CAAEA,MAAM,CAAC,CAEnF,GAAI,CACC,KAAM,CAAAhB,QAAQ,CAAG,KAAM,CAAAJ,KAAK,CAAC,+BAA+B,CAAE,CAC1DwB,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAC/CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACP,UAAU,CACnC,CAAC,CAAC,CACF,KAAM,CAAAQ,YAAY,CAAG,KAAM,CAAAzB,QAAQ,CAAC0B,IAAI,CAAC,CAAC,CAC1CvB,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEqB,YAAY,CAAC,CAEzC,GAAG,CAACzB,QAAQ,CAAC2B,EAAE,CAAE,CACb,KAAM,IAAI,CAAAC,KAAK,CAAC,qBAAqB,CAAC,CAC1C,CAEA,KAAM,CAAA1B,IAAI,CAAGqB,IAAI,CAACM,KAAK,CAACJ,YAAY,CAAC,CACrCtB,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEF,IAAI,CAAC,CACnD,CAAE,MAAOM,KAAK,CAAE,CACfL,OAAO,CAACK,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC7C,CACH,CAAC,CAEDnC,SAAS,CAAC,IAAM,CACZ,GAAGgB,YAAY,CAAE,CACboB,cAAc,CAAC,CAAC,CACxB,CAEJ,CAAC,CAAC,CAGE,mBACIxB,KAAA,QAAK6C,KAAK,CAAC,UAAU,CAAAC,QAAA,eACjBhD,IAAA,CAACT,MAAM,GAAE,CAAC,cACVS,IAAA,CAACP,QAAQ,GAAC,CAAC,cACXO,IAAA,CAACL,YAAY,GAAE,CAAC,cAChBK,IAAA,CAACN,QAAQ,GAAE,CAAC,cACZQ,KAAA,QAAK+C,SAAS,CAAC,UAAU,CAAAD,QAAA,eACrB9C,KAAA,QAAK+C,SAAS,CAAC,aAAa,CAAAD,QAAA,eACxBhD,IAAA,OAAAgD,QAAA,CAAI,eAAa,CAAI,CAAC,cACrBhD,IAAA,CAACR,SAAS,GAAE,CAAC,cACdQ,IAAA,OAAAgD,QAAA,CAAI,qBAAmB,CAAI,CAAC,EAC3B,CAAC,cACNhD,IAAA,QAAKiD,SAAS,CAAE,eAAe,CAAAD,QAAA,cAC3BhD,IAAA,WAAQiD,SAAS,CAAE,gBAAgB,CAAAD,QAAA,cACnChD,IAAA,CAACJ,IAAI,EAACmC,EAAE,CAAC,eAAe,CAACkB,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAC,eAAa,CAAM,CAAC,CACxD,CAAC,CACR,CAAC,cACNhD,IAAA,QAAK+C,KAAK,CAAE,cAAc,CAAAC,QAAA,cACtBhD,IAAA,WAAQiD,SAAS,CAAC,gBAAgB,CAAAD,QAAA,cAClChD,IAAA,CAACJ,IAAI,EAACmC,EAAE,CAAC,cAAc,CAACkB,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAC,oBAAkB,CAAM,CAAC,CAC5D,CAAC,CACR,CAAC,cACNhD,IAAA,QAAKiD,SAAS,CAAE,WAAW,CAAAD,QAAA,cACvBhD,IAAA,WAAQiD,SAAS,CAAC,gBAAgB,CAAAD,QAAA,cAC9BhD,IAAA,CAACJ,IAAI,EAACmC,EAAE,CAAC,WAAW,CAACkB,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAC,UAAQ,CAAM,CAAC,CACnD,CAAC,CACR,CAAC,cACNhD,IAAA,QAAKiD,SAAS,CAAE,WAAW,CAAAD,QAAA,cACvBhD,IAAA,WAAQiD,SAAS,CAAC,gBAAgB,CAAAD,QAAA,cAClChD,IAAA,CAACJ,IAAI,EAACmC,EAAE,CAAC,WAAW,CAACkB,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAC,WAAS,CAAM,CAAC,CAChD,CAAC,CACR,CAAC,EAEL,CAAC,EAGL,CAAC,CAKd,CAAC,CACD,cAAe,CAAA7C,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}